{\bfseries{Dr. Chen-\/\+Hanson Ting}}, the creator of {\bfseries{e\+Forth}} and one of the inspiring figures of Forth community, wrote\+: \begin{quote}
{\itshape In all these years, I have thought that the e\+Forth Model is a good model useful for all different processors and microcontrollers, and for all different applications. It is a very simple model for anybody who like to learn Forth and to use it for their own applications.} \end{quote}


In 2011, Dr. Ting created \href{https://chochain.github.io/eForth1/ref/328eForth.pdf}{\texttt{ $\ast$328e\+Forth$\ast$}} to run Forth on Arduino U\+NO and wrote in his ce\+Forth\+\_\+33 document\+: \begin{quote}
{\itshape I was attracted to Arduino Uno Kit and ported e\+Forth to it as 328e\+Forth...writing to flash memory, I had to take over the bootload section which was monopolized by Arduino I\+DE...I extended Forth dictionary in the R\+AM memory. It worked. However, you had only 1.\+5\+KB of R\+AM memory left over for new Forth words, and you could not save these new words before you lost power. As I stated then, it was only a teaser to entice new people to try Forth on Arduino Uno.} \end{quote}


Before Dr. Ting conceded his fight with cancer in May, 2022, I\textquotesingle{}ve spent the last 11 months working with him expanding the concept of $\ast$$\ast$\char`\"{}\+Forth without Forth\char`\"{}$\ast$$\ast$ -\/ a new e\+Forth model -\/ he called. Traditionally, Forth is built with a set of core words in low-\/level assembly language and establish the rest of words with high-\/level Forth scripts which get boot-\/strapped on start-\/up time. Nowadays, build Forth without using Forth, he reasoned that Forth built entirely in high-\/level languages, specifically in C, can not only greatly simplify the virtual machine, utilizing operating system, but also encourage portability and optimization. Taking the concept forward, we completed new batch of e\+Forths in Javascript, Java, C++, ported them to Windows, E\+S\+P32 in just a few months. Dr. Ting presented a video on November, 2021 to \href{https://www.youtube.com/watch?v=bb5vi9kR1tE&t=827s}{\texttt{ $\ast$\+Sillicon Valley Forth Interest Group$\ast$}}. Later, we fancied creating a hardware version e\+Forth with System\+Verilog and joint venture with Don \& Demitri\textquotesingle{}s C\+O\+R\+E-\/I F\+P\+GA project of \href{https://www.facebook.com/groups/1304548976637542}{\texttt{ $\ast$\+AI \& Robotics Group$\ast$}} til Dr. Ting\textquotesingle{}s eventual departure. The project is still active now.

Personnally, I enjoyed the beauty of working on something small and simple, so decided to pick up Dr. Ting\textquotesingle{}s e\+Forth Model and have fun with it. Since his {\itshape 328e\+Forth} was a teaser only, to move it forward, there are a few major things I need to make changes to Dr. Ting\textquotesingle{}s implementation i.\+g. make C-\/coder friendly macro assembler, remove dependency on extra bootloader programmer, add E\+E\+P\+R\+OM save/load, and support interrupts, ... So, here we go!

\doxysubsection*{What is e\+Forth1?}


\begin{DoxyItemize}
\item An e\+Forth for Arduino U\+N\+O/\+Nano implemented in C.
\item A .ino file that can be openned in Arduino I\+DE and load/run directly onto Arduino.
\item Has 16-\/bit cells and stacks.
\item Can read/write Arduino pins.
\item Supports Arduino Timer and Pin Change Interrupts.
\item Has C A\+PI to interface with user defined functions written in .ino.
\item Can save/load app to/from E\+E\+P\+R\+OM.
\item Can be embeded with other Arduino applications.
\item Become Turnkey system booting from saved E\+E\+P\+R\+OM.
\end{DoxyItemize}

\doxysubsection*{How to install e\+Forth1?}


\begin{DoxyItemize}
\item From Arduino I\+DE\textquotesingle{}s Library Manager \begin{quote}


$>$ Make sure you\textquotesingle{}ve hooked up one of Arduino Nano/\+Uno, or a development board that hosts A\+Tmega328

$>$ from {\itshape Arduino I\+DE $>$ Tools $>$ Manage} Libraries, enter F\+O\+R\+TH in search box

$>$ find e\+Forth1 in the short list, select the latest version, and click the Install button

$>$ from {\itshape Files $>$ Examples}, find e\+Forth1 in Examples from Custom Libraries at very buttom section

$>$ load one of the e\+Forth1 examples, such as {\itshape 0\+\_\+hello}

$>$ open Serial Monitor, set baud rate to {\itshape 115200}, and line ending to {\itshape Both NL \& CR}

$>$ hit compile and upload. You should see the \textquotesingle{}ok\textquotesingle{} prompt

\end{quote}

\item Or, from Git\+Hub directly, if you prefer managing source codes manually \begin{quote}


$>$ git clone \href{https://github.com/chochain/eForth1}{\texttt{ $\ast$https\+://github.com/chochain/e\+Forth1$\ast$}} onto your local Sketch directory

$>$ copy {\itshape examples/0\+\_\+hello/0\+\_\+hello.\+ino} from sub-\/directory, then rename it as {\itshape \mbox{\hyperlink{eforth1_8ino}{eforth1.\+ino}}}

$>$ open {\itshape \mbox{\hyperlink{eforth1_8ino}{eforth1.\+ino}}} with Arduino I\+DE, and setup your Nano/\+Uno (or A\+Tmega328) development board

$>$ in {\itshape \mbox{\hyperlink{eforth1_8ino}{eforth1.\+ino}}}, change the {\itshape \#include $<$eforth1.\+h$>$} to {\itshape \#include \char`\"{}./src/eforth1.\+h\char`\"{}}

$>$ open Serial Monitor, set baud rate to {\itshape 115200}, and line ending to {\itshape Both NL \& CR}

$>$ compile and upload, you should see the \textquotesingle{}ok\textquotesingle{} prompt

\end{quote}

\end{DoxyItemize}

Hopefully, thing goes well and you get something like the snip below if e\+Forth1 is uploaded successfully.


\begin{DoxyItemize}
\item $>$ ~\newline

\end{DoxyItemize}

Now type {\bfseries{W\+O\+R\+DS}} in the input bar and hit $<$return$>$ to list all the words supprted by e\+Forth1. It is ready to serve your future fun projects.


\begin{DoxyItemize}
\item $>$ 
\end{DoxyItemize}

\doxysubsection*{Different from Dr. Ting\textquotesingle{}s}


\begin{DoxyItemize}
\item Instead of direct G\+P\+IO port manipulation with byte read/write, e\+Forth1 calls Arduino library functions i.\+g. P\+I\+N\+M\+O\+DE = pin\+Mode, IN = digital\+Read, O\+UT = digital\+Write, ... for familiarity to the I\+DE platform.
\item e\+Forth1 supports multi-\/tasking through interrupts. It provides a base frequency at 0.\+01\+Hz using Timer2. You assign mulply of 10ms as I\+SR repetition trigger period. For example 500 means 500 x 10ms = every 5 seconds. Timer1 is left free for Servo or other libraries.
\item On this 16-\/bit system, C\+L\+O\+CK will return a double number (i.\+e. 32-\/bit) which takes 2 cells off stack. To calculate time difference, double arithmetic is needed, i.\+e. using D\+N\+E\+G\+A\+TE, D+, or D-\/ and the conversion words D$>$S, S$>$D.
\item D\+E\+L\+AY takes a 16-\/bit value. So, max delay time is 32767ms. Longer delay will have to use loops. Also, D\+E\+L\+AY does not interfer with interrupts (see demos below).
\end{DoxyItemize}

\doxysubsection*{Demos}


\begin{DoxyItemize}
\item L\+ED blinker (assume you have a blue L\+ED on pin 6, or try \href{https://wokwi.com/projects/356793878308297729}{\texttt{ $\ast$this Wokwi project$\ast$}}) 
\begin{DoxyPre}
    > 1 6 pinmode⏎                           \textbackslash{} set pin 6 for OUTPUT, i.e. pinMode(6, OUTPUT=1)
    > : blue 6 in 1 xor 6 out ;⏎             \textbackslash{} create a word to toggle the blue LED
    > : blink for blue 500 delay next ;⏎     \textbackslash{} create a word to blink (i.e. 500ms delay)
    > 9 blink⏎                               \textbackslash{} run 10 cycles (i.e. 9,8,7,...,2,1,0 to on/off 5 times)
    \end{DoxyPre}

\item Timer Interrupt Service Routine (a red L\+ED on pin 5) 
\begin{DoxyPre}
    > 1 5 pinmode⏎                           \textbackslash{} set pin 5 for OUTPUT
    > : red 5 in 1 xor 5 out ;⏎              \textbackslash{} create an interrupt service routine (just a regular word)
    > ' red 20 tmisr⏎                        \textbackslash{} make the ISR ticked every 0.2 seconds (= 20 x 10ms)
    > 1 timer⏎                               \textbackslash{} enable timer, now you should see red LED blinking continuously
    > 19 blink⏎                              \textbackslash{} let's have them both blink (blue LED 10 times) 
    \end{DoxyPre}


$\vert$$\vert$$\vert$ $\vert$\+:--$\vert$\+:--$\vert$ $\vert$$\vert$$\vert$
\item Drives 8 Servos at \href{https://wokwi.com/projects/356866133593965569}{\texttt{ $\ast$this Wokwi project$\ast$}}
\end{DoxyItemize}

\doxysubsection*{Benchmark}


\begin{DoxyItemize}
\item Classic 1 million cycles 
\begin{DoxyPre}
    > : xx 999 for 34 drop next ;⏎           \textbackslash{} inner loop (put 34 on stack then drop it)
    > : yy 999 for xx next ;⏎                \textbackslash{} create the outer loop
    > : zz clock dnegate yy clock d+ ;⏎      \textbackslash{} CLOCK returns a double value
    > zz⏎                                    \textbackslash{} benchmark the 1000x1000 cycles
    > 24495 0 ok>                            \textbackslash{} 24495ms =\string~ 24.5us/cycle (with one blinking ISR running in the background)
    \end{DoxyPre}

\end{DoxyItemize}

\#\doxysection*{To Learn More About Forth?}

If your programming language exposure has been with C, Java, or even Python so far, F\+O\+R\+TH is quite {\bfseries{different}}. Quote Nick\+: {\itshape \char`\"{}\+It\textquotesingle{}s no functional or object oriented, it doesn\textquotesingle{}t have type-\/checking, and it basically has zero syntax\char`\"{}}. No syntax? So, anyway, before you dive right into the deep-\/end, here\textquotesingle{}s a good online materials.
\begin{DoxyItemize}
\item Interactive tutorial for F\+O\+R\+TH primer. It teaches you how F\+O\+R\+TH fundamentally works such as the numbers, the stack, and the dictionary. \begin{quote}
\href{https://skilldrick.github.io/easyforth/\#introduction}{\texttt{ $\ast$\+Easy Forth Tutorial by Nick Morgan$\ast$}} with a \href{https://wiki.forth-ev.de/lib/exe/fetch.php/en:projects:a-start-with-forth:05_easy_forth_v16_a5_withexp_comments.pdf?fbclid=IwAR0sHmgiDtnMRuQtJdVkhl9bmiitpgcjs4ZlIDVtlxrssMOmLBv0vesvmKQ}{\texttt{ $\ast$\+Writeup$\ast$}} by Juergen Pintaske. \end{quote}

\end{DoxyItemize}

To understand the philosophy of F\+O\+R\+TH, excellent online e-\/books are here free for you.
\begin{DoxyItemize}
\item Timeless classic for the history, paths, and thoughts behind F\+O\+R\+TH language. \begin{quote}
\href{http://home.iae.nl/users/mhx/sf.html}{\texttt{ $\ast$\+Starting Forth by Leo Brodie$\ast$}}~\newline
 \href{http://thinking-forth.sourceforge.net}{\texttt{ $\ast$\+Thinking Forth by Leo Brodie$\ast$}} \end{quote}

\end{DoxyItemize}

\doxysubsection*{Performance Tuning ($\sim$15\% faster)}


\begin{DoxyItemize}
\item Check your Arduino I\+DE installed directory, say {\itshape C\+:\textbackslash{}\+Users\textbackslash{}myname\textbackslash{}\+App\+Data\textbackslash{}\+Local\textbackslash{}\+Arduino...} on Windows or {\itshape /home/myname/\+Arduino/...} on Linux,
\item Find the directory {\itshape hardware -\/$>$ arduino -\/$>$ avr},
\item With an editor, open the {\itshape \textquotesingle{}platform.\+txt\textquotesingle{}} file,
\item Find all three -\/Os compiler options (i.\+g. compiler.\+c.\+flags=-\/c -\/g -\/Os ...) \begin{quote}
change them to -\/O3 for speed, -\/Os (default) for smallest size, -\/O2 for somewhere in-\/between \end{quote}

\end{DoxyItemize}

\doxysubsection*{References to Dr. Ting\textquotesingle{}s Original}


\begin{DoxyItemize}
\item \href{https://chochain.github.io/eForth1/ref/1013_eForthAndZen.pdf}{\texttt{ {\itshape e\+Forth and Zen}}}
\item \href{https://chochain.github.io/eForth1/ref/The_Arduino_controlled_by_eForth.pdf}{\texttt{ {\itshape The Arduino controlled by e\+Forth}}}
\item \href{https://github.com/DRuffer/328eforth}{\texttt{ {\itshape 328e\+Forth mod for coin\+Forth by D. Ruffer}}}
\item \href{https://chochain.github.io/eForth1/ref/ceForth_33.doc}{\texttt{ {\itshape ce\+Forth\+\_\+33.\+doc -\/ original documentation}}}
\item \href{https://chochain.github.io/eForth1/ref/ceForth_33.cpp}{\texttt{ {\itshape ce\+Forth\+\_\+33.\+cpp -\/ source code in C}}}
\item \href{https://chochain.github.io/eForth1/ref/eforth_328.ino}{\texttt{ {\itshape eforth\+\_\+328.\+ino -\/ Arduino I\+DE teaser by Dr. Ting}}}
\end{DoxyItemize}

\doxysubsection*{For Projects small and large}


\begin{DoxyItemize}
\item A tiny 8-\/bit sytem at \href{https://github.com/TG9541/stm8ef}{\texttt{ {\itshape e\+Forth for S\+T\+M8}}} or \href{https://github.com/TG9541/stm8ef/wiki/STM8S-Programming\#flashing-the-stm8}{\texttt{ {\itshape S\+T\+M8 Programming}}}
\item A system with Wi\+Fi, and fancy stuffs at \href{https://esp32forth.appspot.com/ESP32forth.html}{\texttt{ {\itshape Esp32forth}}} or its \href{https://github.com/Esp32forth}{\texttt{ {\itshape Git\+Hub site}}} 
\end{DoxyItemize}